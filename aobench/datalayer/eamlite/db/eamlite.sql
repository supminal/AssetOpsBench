create table jobplans (
  jobplanid int generated by default as identity primary key,
  plannum varchar(50) unique not null,
  description varchar(255),
  estimatedhours decimal(5,2)
);

create table workorderstatus (
  statusid int generated by default as identity primary key,
  statusname varchar(50),
  description varchar(255)
);

create table assets (
  assetid int generated by default as identity primary key,
  assetnum varchar(50) unique not null,
  description varchar(255),
  locationid int,
  status varchar(50),
  assettype varchar(50),
  manufacturer varchar(100),
  modelnum varchar(100),
  serialnum varchar(100),
  purchasedate date,
  warrantyenddate date
);

create table assettypes (
  assettypeid int generated by default as identity primary key,
  typename varchar(50),
  description varchar(255)
);

create table workorderlabor (
  laborid int generated by default as identity primary key,
  workorderid int,
  employeeid int,
  hoursworked decimal(5,2),
  workdate date
);

create table failurecodes (
  failurecodeid int generated by default as identity primary key,
  code varchar(50),
  description varchar(255)
);

create table maintenanceschedules (
  scheduleid int generated by default as identity primary key,
  assetid int,
  frequency varchar(50),
  lastservicedate date,
  nextservicedate date
);

create table assetstatus (
  statusid int generated by default as identity primary key,
  statusname varchar(50),
  description varchar(255)
);

create table itemissues (
  issueid int generated by default as identity primary key,
  inventoryid int,
  workorderid int,
  quantityissued int,
  issuedate date
);

create table assetfailurehistory (
  failureid int generated by default as identity primary key,
  assetid int,
  failurecodeid int,
  failuredate date,
  resolution varchar(255)
);

create table assetmeters (
  meterid int generated by default as identity primary key,
  metername varchar(50),
  assetid int,
  meterreading decimal(10,2),
  readingdate timestamp
);

create table preventivemaintenance (
  pmid int generated by default as identity primary key,
  scheduleid int,
  taskdescription varchar(255),
  estimatedhours decimal(5,2)
);

create table sites (
  siteid int generated by default as identity primary key,
  sitenum varchar(50) unique not null,
  name varchar(100),
  address varchar(255)
);

create table servicerequests (
  servicerequestid int generated by default as identity primary key,
  requestnum varchar(50) unique not null,
  assetid int,
  locationid int,
  status varchar(50),
  priority int,
  description varchar(255),
  requestdate date
);

create table workorders (
  workorderid int generated by default as identity primary key,
  workordernum varchar(50) unique not null,
  assetid int,
  locationid int,
  type varchar(50),
  status varchar(50),
  priority int,
  description varchar(255),

  startdate timestamp,
  enddate timestamp,
  actual_finish timestamp
);

create table locations (
  locationid int generated by default as identity primary key,
  locationnum varchar(50) unique not null,
  description varchar(255),
  siteid int,
  locationtype varchar(50)
);

alter table itemissues add foreign key (workorderid) references workorders (workorderid);

alter table servicerequests add foreign key (locationid) references locations (locationid);

alter table assetfailurehistory add foreign key (failurecodeid) references failurecodes (failurecodeid);

alter table servicerequests add foreign key (assetid) references assets (assetid);

alter table workorders add foreign key (assetid) references assets (assetid);

alter table preventivemaintenance add foreign key (scheduleid) references maintenanceschedules (scheduleid);

alter table maintenanceschedules add foreign key (assetid) references assets (assetid);

alter table workorderlabor add foreign key (workorderid) references workorders (workorderid);

alter table assetmeters add foreign key (assetid) references assets (assetid);

alter table assetfailurehistory add foreign key (assetid) references assets (assetid);

alter table workorders add foreign key (locationid) references locations (locationid);

alter table locations add foreign key (siteid) references sites (siteid);

alter table assets add foreign key (locationid) references locations (locationid);
